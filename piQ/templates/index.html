<!DOCTYPE html>
<html>
<head>
    <title> FyeFO (Sign-In)</title>

    <!--<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/style.css') }}">-->

    <!--<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>-->

</head>
<body onload="on_load()">
    <h1> FyeFo: The CS301 Help Desk Queue (Sign-In)</h1>

    <div id = "form">
        <form id="myForm" action= "/" method="POST">
          Scan you Buzzcard or type your GTID (9-digit number) below! <input type="text" oninput="auto_submit()" name="gtid" id="gtid" autofocus>
          <input type="submit" name="add" value="Submit">



        </form>
    </div>

<div id="queue">
</div>

<script>
function auto_submit() {
  let x = document.getElementById("gtid").value;
  if (x.length == 9) {
    document.getElementById("myForm").submit();
  }

}
function on_load() {
  fetch("/queue").then(function(response) {
    return response.json()
  })
  .then(function(myJson) {
    load_queue(myJson["queue"]);
  });
}

function load_queue(response) {
  console.log(response);
  let arr = response;
  let element = document.getElementById("queue");

  for (var i = 0; i < arr.length; i++) {
    let num = (i + 1).toString() + ". ";
    var para = document.createElement("p");
    var node = document.createTextNode(num + arr[i]);
    para.appendChild(node);
    element.appendChild(para);
  }




}
</script>

</body>
</html>
